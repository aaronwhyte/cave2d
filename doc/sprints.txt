DONE 2018-11-19
make nest for game 6
v copy game5 to game6
v rename stuff
v playable again
v an adventure

DONE 2018-11-19
Misc fixes and stuff
v Fix JsonStorage?
  Not sure what's going on there but the test fails, and getting mutates return values, so that's not good.
v replace & delete ObjSet
v replace & delete ArraySet
v replace & delete my Map class

DONE 2018-11-20
Let a player play entirely with the mouse, to (eventually) free up the keyboard for more players.
v add mouse right/left buttons to pointerlocked controller. Except Safari where right-click is unblockable?
v fix MouseButtonTrigger button detection when both buttons are held.
v remove right-click context menu on the canvas on Safari

intro page
* Is a ScreenPage, so it needs a level path to a level in the file system
* Will include Printer-based text thingy hovering in the screen
* World will come from editor, unless/until I get procgen working
* whole screen is also listener to determine what input device is default for plr.
v nest class
v custom-made world runs in the bg
v print game title
v print "PRESS TO BEGIN"

space and planetoid
v invert wall and void
  v world loader
  v editor
  v mine painting
  v bullet painting
  v new intro level

convert player from game6
v remove shield
v use thrust while flying, no (or very little) traction
v remove tractor beam

prototype player controls & transformation
v button to switch modes for now
v driving
  v sticks to wall
    v at least two rayscans determine dists to wall
    v apply force at point based on dist to wall.
  v movement along wall is fast and traction-y, not very floaty
  v no movement that is not along wall
  v button-down immediately jumps off of wall (or just changes modes?)
  v allow rotation when in drive mode in open space

v remove mode-switch button - make it part of natural motion! One button only: fire.

enemies and levels are lessons
- lesson: drive and shoot
  - open-space enemies that float far enough from an anchor wall that you can always drive under them and shoot 'em.
    - They can shoot when you get close enough. No prob, just keep driving.
  - ground-based turrets on a wall that faces another wall
  - ground hoppers that launch up when you approach, then dive at you
- lesson: dodge while on the ground
  - enemies that float above and drop bombs (sense of gravity, planet center, altitude)
  - ground rockets that launch up when you approach, then dive & explode
- lesson: leave the ground briefly when needed
  - flying enemies drop ground-hugging missiles, forcing you to jump over them
  - explosive effects that hug the ground
  - rolling bullets like donkey-kong barrels
- lesson: take cover
  - tough enemy that has a player-following rapid-fire phase. Hide behind stuff when that gets going, and fire when they pause.
    (example: Big Bandit in Nuclear Throne)
  - stationary enemy that contantly fires at you when you're anywhere close and in line of sight. Rotating field of view maybe?
  - hovering enemy that fires a periodic burst
- lesson: fly and shoot the ground
  - turrets positioned so there's no opposite wall to shoot from
  - wall-runners that chase you
- lesson: wall jump & get a good angle
  - wide tunnels with turrets and wall-runners
  - levels with interesting interior arenas
  - indoor mazes where you need to get to a certain spot to be able to shoot a thing to get to the next spot etc.
- lesson: run and fire backwards
  - tough flying enemies that chase you around the planet, that fire ground-huggers or something to keep you off the ground.
  - seeker missiles that have a big blast radius
- lesson: maneuver swarming enemies into kill-zones
  - flying enemies that chase you - force them into bottleneck opening
  - ground-based critters that that chase you: Use wavy ground to aim ground-gun at them.
- lesson: Fly and shoot flying things
  - space enemies (Defender ships?) that stay at your altitude so you need to fly and shoot sideways to get them.
  - flying chasers that come out of the ground, that are easy to shoot as you fly away
- lesson: be careful what you shoot
  - high explosives in close quarters
  - enemies that change when they die
    - enemies that explode
    - enemies that turn into more, smaller enemies (asteroids, slimes, defender diamonds)
    - enemies that turn into obstacles when shot - centipede
  - enemies that are altered by being shot
    - drivers become flyers
    - drivers leap across to opposite wall
    - flyers become drivers
    - sleepers become attackers
- lesson: some things you cannot fight
  - indestructible chasers that are too big to fit through small openings
  - indestructible guards that laser you on sight


- land on contact, not on longer-range scan

plr grx and snd
- driving
  - ground-effect (particles?)
  - driving sound
  - trail
  - launch sound
- flying
  - thrust particles
  - thrust/speed sound
  - trail

complications
- fire-keydown effects
  - charge first shot when not firing, so timing first shot can be crucial
    - special enemies that can only be hit with charge-shot
    - charge when not firing but only launch charge when releasing, to give player chance to aim well?
      - holding down fire drains charge shot so player must decide between occasional charged shots or steady stream
- indestructible targets can be destroyed when the player is very powered up
  - powering up comes from maxing out your combo bonus
    - combo bonus from gathering collectibles enemies drop
      - enemies drop collectibles
- power-ups for general game perversion
  - ramming power
  - rapid fire (maybe don't start off as such a blaster)
  - shield
  - super-controlled flight
  - explosive shells - for digging?
  - forward-firing seeker missiles
  - one-time explosive burst
  - bouncy bullets
  - gravity-following bombs
- fun props
  - neutral mines (hi game 5!) that are a benefit or a hazard. They don't blow walls tho.
  - mines that DO blow up walls, for level transformation
  - Orbs that bullets bounce off of
  - Orbs that will throw you pinball-like
  - Destructible orbs that you can walk across
  - teleporters obviously
  - spikey/zappy orbs that restrict movement
  - periodic zappers, like Caves of Mars, especially when you're running away

main menu
- shows existing joined player slots, with good default player
- "players & controls"
- instructions
- "play!" if there's at least one player

player add/drop menu
- possible players are represented as slots
  - 3 keyboard/mouse slots
  - 4 touchscreen slots
- show list of existing controls
  - pause key (editable?? not yet)
  - 3 keyboard/mouse slots
    - one slot at a time in a list
    - actions
      - name
      - description
      - trigger: key or mouse button
    - movement
      - 4 keys (wasd, ijkl, arrows, etc)
        - names for arrow keys
      - or mouse
    - edit button (placeholder for now)
  - 4 touch pad slots, each with own minimap
    - buttons
      - in arc in corner of quadrant
      - marked with symbols
    - movement zone
      - rect overlap resolution:
        - home quadrant always wins
        - In unowned quadrant, short-sided region wins.
        - In square screen (??) neither gets it. Just don't explode. This Should Never Happen.
  - every slot has clear joined/dropped state and a join drop button
  - unusable types are greyed out and below usable ones?

That fixes some problems:
* What keys do I press?
* Which one is tractor beam?
* How do I get rid of player 2?
* How do I _add_ player 2?

Editable controls
- individual keyboard/mouse slot editor
  - list of all controls in slot
    - action buttons
    - movement type selector
      - mouse
      - keyboard
        - movement keys
  - click trigger to open for edit
      - accept keypress or mouse button
        - if already taken by other slot, still OK to steal it. Allow cross-player-slot conflicts, but highlight them.
        - if key already taken by *this* slot, delete prev key use.
  - "back to menu" button
- touchscreen slots all shown/editable at once, WYSIWYG
  - starts paused
    - symbols are explained here
    - "edit" button
    - "back" button
  - pause button is always visible when unpaused
  - home quadrant cannot change. There are 4 and that's that.
  - player action buttons
    - in arc in corner of quadrant
    - marked with symbols
    - allow dragging within quadrant
    - show symbol meaning nearby
  - movement rect starts in corner of quadrant, and extends in extends in X OR Y direction
    - let player switch axis by touching curved arrow in the elbow
  - constant preview of movement zones
- auto save/load prefs
  - LocalStorage s27n
